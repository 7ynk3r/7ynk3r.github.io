name: Gemini Research and Create File

on:
  workflow_dispatch: # Allows manual triggering

jobs:
  research:
    runs-on: ubuntu-latest
    permissions:
      contents: "write" # Required to commit the new file
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run Gemini CLI
        id: gemini_run
        uses: google-github-actions/run-gemini-cli@v1
        with:
          prompt: "Summarize the top 3 AI news headlines from the past 48 hours in markdown format."
          gemini_api_key: ${{ secrets.GEMINI_API_KEY }}

      - name: Create file with Gemini's response
        run: echo "${{ steps.gemini_run.outputs.text }}" > ai_news.md

      - name: Verify file content
        run: |
          echo "File created: ai_news.md"
          cat ai_news.md

      - name: Commit the new file
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add ai_news.md
          git commit -m "Add latest AI news summary"
          git push
